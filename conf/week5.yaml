# 5주차 프롬프트 튜닝 기본 설정

# Hydra 기본 설정 (파일 내 설정을 우선 적용)
defaults:
  - _self_

## Hydra 실행 관련 옵션
hydra:
  run:
    # 실행 로그 및 결과 저장 경로
    dir: outputs/week5/${now:%Y%m%d_%H%M%S}
  job:
    # 실행 중 현재 디렉터리를 변경하지 않음
    chdir: false

llm:
  # 기본 LLM 모델 이름
  model_name: gemini-2.5-flash
  # 출력 다양성을 조절하는 온도값
  temperature: 0.2
  # LLM 파라미터 (Gemini API 지원)
  top_p: null  # 누적 확률 기반 샘플링 (None이면 기본값 사용)
  top_k: null  # 상위 K개 토큰 중 선택 (None이면 기본값 사용)
  # 실행 전에 API 키 존재 여부를 확인할지
  ensure_api_key: true

variants:
  # 프롬프트 실험에 사용할 각 변형 정의
  - name: baseline
    system: "당신은 도움이 되는 분석가입니다."
    user: "LangChain의 RAG 파이프라인에 대해 50자로 요약해 주세요."
  - name: cot
    system: "당신은 체계적으로 추론하는 AI 컨설턴트입니다. 답변을 내기 전 반드시 단계별로 사고 과정을 작성하세요."
    user: "LangChain의 RAG 파이프라인 구성 요소와 흐름을 설명해 주세요. 생각을 단계적으로 작성한 뒤 결론을 요약해 주세요."
  - name: structured
    system: >
      당신은 기술 문서를 작성하는 전문가입니다. 답변은 반드시 JSON 형식으로 반환하세요.
      키는 'pipeline_overview', 'key_components', 'tips' 세 가지로 하고, 각 값은 문자열 또는 문자열 리스트로 구성하세요.
    user: "LangChain의 RAG 파이프라인을 요약하고, 핵심 구성 요소와 활용 팁을 알려주세요."
  - name: few_shot
    system: "당신은 시니어 AI 엔지니어입니다. 간결하면서도 실제 프로젝트 인사이트를 담아 답변하세요."
    user: "LangChain의 RAG 파이프라인을 요약하고, 성공적인 프로젝트 수행을 위한 조언을 제시해 주세요."
    examples:
      # few-shot 방식으로 참고할 Q&A 페어
      - question: "ChatGPT API를 활용한 고객지원 챗봇 구축 단계를 요약해 줘."
        answer: "1) 범위 정의 및 데이터 정리 -> 2) 프롬프트 설계와 테스트 -> 3) 배포 및 모니터링으로 정리할 수 있습니다."
      - question: "LangChain 에이전트를 사용할 때 주의할 점은?"
        answer: "외부 도구 호출 오류 처리, 프롬프트 가드레일, 사용자 피드백 루프를 설계하는 것이 좋습니다."

output:
  # 결과 저장 파일 경로 (null이면 저장하지 않음)
  save_path: null          # 예: ${hydra:run.dir}/results.txt
  # 콘솔에 결과 출력 여부
  print_results: true
  # LLM 응답 통계/분석을 함께 출력할지
  show_analytics: true

langgraph:
  enabled: true
  # Week3에서 생성한 인덱스 경로
  index_dir: ../../data/processed/index
  retrieval_k: 5
  max_context_docs: 4
  # LangGraph 데모용 LLM 설정 (미지정 시 llm 섹션과 동일하게 사용)
  model_name: null
  temperature: 0.1
  # LLM 파라미터 (Gemini API 지원 확인 필요)
  top_p: null
  top_k: null
  embedding_model: sentence-transformers/all-MiniLM-L6-v2
  # 조건부 분기 설정
  enable_conditional_branching: false  # true로 설정하면 재검색 및 키워드 기반 프롬프트 활성화
  reretrieve_threshold: 0.3  # 문서 관련성 임계값 (이 값보다 낮으면 재검색)
  max_reretrieves: 1  # 최대 재검색 횟수
  # 키워드별 프롬프트 템플릿 (질문에 키워드가 포함되면 해당 프롬프트 사용)
  keyword_prompts:
    # 긴급: "긴급 상황에 대한 답변입니다. 빠르고 정확한 정보를 제공하세요."
    # 상세: "상세한 설명이 필요한 질문입니다. 구체적이고 자세하게 답변하세요."
  # 콘솔 출력 옵션
  show_context: true
  preview_limit: 2
  demo_questions:
    - "그랜드코리아레저의 코로나 대응 전략은 무엇인가?"
    - "RAG 파이프라인에서 문서 검색 단계의 핵심 포인트는?"

